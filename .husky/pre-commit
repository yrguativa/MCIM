#!/bin/sh

# Only run checks if there are staged files
if git diff --cached --quiet; then
  exit 0
fi

echo "ğŸ” Running pre-commit checks..."

# Check if backend files changed
if git diff --cached --name-only | grep -q "^cells-back/"; then
  echo "ğŸ”¨ Building backend..."
  cd cells-back && npm run build
  if [ $? -ne 0 ]; then
    echo "âŒ Backend build failed"
    exit 1
  fi
  cd ..
fi

# Check if frontend files changed
if git diff --cached --name-only | grep -q "^app/"; then
  echo "ğŸ§¹ Linting frontend..."
  cd app && npm run lint
  if [ $? -ne 0 ]; then
    echo "âŒ Frontend lint failed"
    exit 1
  fi
  cd ..
fi

echo "âœ… Pre-commit checks passed!"
